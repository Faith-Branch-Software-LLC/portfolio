"use client";

import { useRef, useEffect } from "react";
import gsap from "gsap";
import { DrawSVGPlugin } from "gsap/DrawSVGPlugin";
import { MorphSVGPlugin } from "gsap/MorphSVGPlugin";

// Register GSAP plugins
if (typeof window !== "undefined") {
  gsap.registerPlugin(DrawSVGPlugin, MorphSVGPlugin);
}

// ============================================
// ANIMATION DURATIONS (in seconds)
// ============================================
const D = {
  circleLeft: 0.5,
  mainBar: 1.6,
  circleRight: 0.5,
  branch: 0.5,
  branchCircle: 0.3,
  treeMorph: 0.16,    // Per morph step (seed → grow1 → ... → base)
  treeStroke: 2.4,
  treeFill: 0.3,
  leaf: 0.3,
  shadow: 0.8,
};

interface AnimatedLogoProps {
  className?: string;
  autoPlay?: boolean;
  onAnimationComplete?: () => void;
}

export default function AnimatedLogo({
  className,
  autoPlay = true,
  onAnimationComplete,
}: AnimatedLogoProps) {
  const svgRef = useRef<SVGSVGElement>(null);

  // Main element refs
  const mainCircleLeftRef = useRef<SVGGElement>(null); // #_11
  const mainBarRef = useRef<SVGGElement>(null); // #_21
  const mainCircleRightRef = useRef<SVGGElement>(null); // #_3

  // Branch refs
  const branch1Ref = useRef<SVGPathElement>(null);
  const branch2Ref = useRef<SVGGElement>(null);
  const branch2PathRef = useRef<SVGPathElement>(null); // #_1
  const branch2CircleRef = useRef<SVGGElement>(null); // #_2
  const branch3Ref = useRef<SVGPathElement>(null);

  // Tree refs
  const treeRef = useRef<SVGGElement>(null);
  const treeSeedRef = useRef<SVGPathElement>(null);
  const treeGrow1Ref = useRef<SVGPathElement>(null);
  const treeGrow2Ref = useRef<SVGPathElement>(null);
  const treeGrow3Ref = useRef<SVGPathElement>(null);
  const treeGrow4Ref = useRef<SVGPathElement>(null);
  const treeGrow5Ref = useRef<SVGPathElement>(null);
  const treeGrow6Ref = useRef<SVGPathElement>(null);
  const treeBaseRef = useRef<SVGPathElement>(null);
  const treeFullRef = useRef<SVGPathElement>(null);

  // Leaf refs
  const leaf1Ref = useRef<SVGPathElement>(null);
  const leaf2Ref = useRef<SVGPathElement>(null);
  const leaf3Ref = useRef<SVGPathElement>(null);
  const leaf4Ref = useRef<SVGPathElement>(null);
  const leaf5Ref = useRef<SVGGElement>(null);

  // Olive refs
  const olive1Ref = useRef<SVGPathElement>(null);
  const olive2Ref = useRef<SVGPathElement>(null);

  // Shadow refs
  const shadowRef = useRef<SVGGElement>(null);

  useEffect(() => {
    if (!svgRef.current) return;

    const ctx = gsap.context(() => {
      // Initialize all elements to hidden state
      // Main circles
      gsap.set([mainCircleLeftRef.current, mainCircleRightRef.current], {
        scale: 0,
        transformOrigin: "center center",
      });

      // Main bar - hidden from left (will reveal right to left)
      gsap.set(mainBarRef.current, {
        clipPath: "inset(0 0 0 100%)",
      });

      // Branches - hidden
      gsap.set([branch1Ref.current, branch2PathRef.current, branch3Ref.current], {
        clipPath: "inset(0 0 0 100%)",
      });

      // Branch2 circle
      gsap.set(branch2CircleRef.current, {
        scale: 0,
        transformOrigin: "center center",
      });

      // Tree morph chain - all hidden except seed
      gsap.set(treeSeedRef.current, { opacity: 0 });
      gsap.set(treeGrow1Ref.current, { opacity: 0 });
      gsap.set(treeGrow2Ref.current, { opacity: 0 });
      gsap.set(treeGrow3Ref.current, { opacity: 0 });
      gsap.set(treeGrow4Ref.current, { opacity: 0 });
      gsap.set(treeGrow5Ref.current, { opacity: 0 });
      gsap.set(treeGrow6Ref.current, { opacity: 0 });
      gsap.set(treeBaseRef.current, { opacity: 0 });
      gsap.set(treeFullRef.current, {
        opacity: 1,
        fillOpacity: 0,
        drawSVG: "0%",
      });

      // Leaves and olives - hidden with proper transform origins
      // Left side of tree - origin on right
      gsap.set(leaf1Ref.current, {
        scale: 0,
        transformOrigin: "0% 0%",
      });
      gsap.set(leaf2Ref.current, {
        scale: 0,
        transformOrigin: "20% 100%",
      });

      // Top center - origin at bottom
      gsap.set(olive1Ref.current, {
        scale: 0,
        transformOrigin: "40% 100%",
      });

      // Right side of tree - origin on left
      gsap.set(leaf3Ref.current, {
        scale: 0,
        transformOrigin: "20% 0%",
      });
      gsap.set(leaf4Ref.current, {
        scale: 0,
        transformOrigin: "20% 100%",
      });
      gsap.set(olive2Ref.current, {
        scale: 0,
        transformOrigin: "30% 10%",
      });
      gsap.set(leaf5Ref.current, {
        scale: 0,
        transformOrigin: "0% 40%",
      });

      // Shadow - hidden
      gsap.set(shadowRef.current, {
        opacity: 0,
      });

      // Build the timeline
      const tl = gsap.timeline({
        paused: !autoPlay,
        onComplete: onAnimationComplete,
      });

      // ========== TimeLine ==========
      tl.to(mainCircleLeftRef.current, {
          scale: 1,
          duration: D.circleLeft,
          ease: "back.out(1.7)",
        })
        .to(mainBarRef.current, {
          clipPath: "inset(0 0 0 0%)",
          duration: D.mainBar,
          ease: "power2.out",
        }, "<+=0.3")  // Starts 0.3s after left circle starts
        .to(branch1Ref.current, {
          clipPath: "inset(0 0 0 0%)",
          duration: D.branch,
          ease: "power2.out",
        }, "<+=0.1")
        .to(branch2PathRef.current, {
          clipPath: "inset(0 0 0 0%)",
          duration: D.branch,
          ease: "power2.out",
        }, "<+=0.1")
        .to(branch3Ref.current, {
          clipPath: "inset(0 0 0 0%)",
          duration: D.branch,
          ease: "power2.out",
        }, "<+=0.2")
        .to(branch2CircleRef.current, {
          scale: 1,
          duration: D.branchCircle,
          ease: "back.out(1.7)",
        }, ">-0.1")  // Slightly overlaps branch2Path
        .to(treeSeedRef.current, {opacity: 1, durration: 0.01}, ">")
        .to(mainCircleRightRef.current, {
          scale: 1,
          duration: D.circleRight,
          ease: "back.out(1.7)",
        }, "-=0.3")
        .to(treeSeedRef.current, { morphSVG: treeGrow1Ref.current!, duration: D.treeMorph, map: "position" })
        .to(treeSeedRef.current, { morphSVG: treeGrow2Ref.current!, duration: D.treeMorph, map: "position" }, ">")
        .to(treeSeedRef.current, { morphSVG: treeGrow3Ref.current!, duration: D.treeMorph, map: "position" }, ">")
        .to(treeSeedRef.current, { morphSVG: treeGrow4Ref.current!, duration: D.treeMorph, map: "position" }, ">")
        .to(treeSeedRef.current, { morphSVG: treeGrow5Ref.current!, duration: D.treeMorph, map: "position" }, ">")
        .to(treeSeedRef.current, { morphSVG: treeGrow6Ref.current!, duration: D.treeMorph, map: "position" }, ">")
        .to(treeSeedRef.current, { morphSVG: treeBaseRef.current!, duration: D.treeMorph, map: "position" }, ">")
        // Draw stroke
        .to(treeFullRef.current, {
          drawSVG: "100%",
          duration: D.treeStroke,
          ease: "sine.inOut",
        }, ">")
        // Fade in fill
        .to(treeFullRef.current, {
          fillOpacity: 1,
          duration: D.treeFill,
          ease: "power1.in",
        }, ">-0.5")  // Starts before stroke finishes
        .to(leaf1Ref.current, { scale: 1, duration: D.leaf, ease: "back.out(1.4)" }, "leaves")
        .to(leaf2Ref.current, { scale: 1, duration: D.leaf, ease: "back.out(1.4)" }, "leaves+=0.3")
        .to(olive1Ref.current, { scale: 1, duration: D.leaf, ease: "back.out(1.4)" }, "leaves+=0.6")
        .to(leaf3Ref.current, { scale: 1, duration: D.leaf, ease: "back.out(1.4)" }, "leaves+=0.9")
        .to(leaf4Ref.current, { scale: 1, duration: D.leaf, ease: "back.out(1.4)" }, "leaves+=1.2")
        .to(olive2Ref.current, { scale: 1, duration: D.leaf, ease: "back.out(1.4)" }, "leaves+=1.5")
        .to(leaf5Ref.current, { scale: 1, duration: D.leaf, ease: "back.out(1.4)" }, "leaves+=1.8")
        .to(shadowRef.current, {
          opacity: 1,
          duration: D.shadow,
          ease: "power2.out",
        }, ">");
    }, svgRef);

    return () => ctx.revert();
  }, [autoPlay, onAnimationComplete]);

  return (
    <svg
      ref={svgRef}
      className={className}
      width="100%"
      height="100%"
      viewBox="0 0 1024 1024"
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
      xmlnsXlink="http://www.w3.org/1999/xlink"
      xmlSpace="preserve"
      style={{
        fillRule: "evenodd",
        clipRule: "evenodd",
        strokeLinejoin: "round",
        strokeMiterlimit: 2,
      }}
    >
      {/* Shadow Group */}
      <g id="Shadow" ref={shadowRef}>
        <path
          id="underLayer"
          d="M283.386,696.919C230.929,696.68 188.858,696.41 165.081,696.12C159.534,716.169 141.145,730.908 119.341,730.908C93.152,730.908 71.89,709.646 71.89,683.457C71.89,657.268 93.152,636.006 119.341,636.006C142.017,636.006 160.999,651.947 165.684,673.224C172.608,673.282 187.343,673.363 207.998,673.462C144.527,447.882 284.724,331.582 357.554,302.813C358.806,285.712 364.819,270.289 372.448,257.119C355.227,243.892 339.307,224.592 374.659,175.408C399.82,140.403 447.23,138.794 467.515,138.536C502.06,138.096 514.309,149.318 549.148,147.998C541.77,156.715 517.023,158.999 495.679,176.822C477.81,191.744 466.209,211.914 452.772,238.873C440.523,263.449 408.683,273.733 387.19,266.098C384.756,274.28 382.788,283.436 381.519,293.673C410.561,282.523 448.5,273.917 493.485,270.985C489.848,267.744 476.19,250.175 501.377,220.872C525.819,200.532 542.598,210.761 548.039,217.112C551.179,220.298 561.884,236.426 539.151,261.21C534.92,264.901 530.952,267.744 527.255,269.899C543.031,269.895 559.512,270.578 576.633,272.057C575.113,243.964 610.889,200.321 672.697,197.57C730.712,194.988 793.729,244.485 793.729,244.485C793.729,244.485 776.173,235.211 749.452,243.376C729.342,249.52 701.352,260.55 682.106,271.849C670.683,278.555 653.376,280.716 638.869,281.346C685.743,290.821 761.723,312.981 837.904,350.54C842.441,349.281 849.792,348.385 857.856,347.967C857.628,346.48 857.555,344.803 857.66,342.907C858.22,332.827 873.591,327.771 892.583,330.881C914.304,334.438 924.318,355.001 936.513,357.927C946.62,360.353 955.952,359.097 955.952,359.097C955.952,359.097 940.429,373.256 918.717,374.361C897.205,375.456 890.599,366.996 885.413,364.185C877.389,359.833 864.497,361.372 859.593,353.075C855.711,353.559 851.76,354.258 847.856,355.211C864.503,363.927 918.49,393.556 926.461,401.321C928.149,403.52 924.793,415.086 915.662,412.368C893.569,397.973 796.894,359.986 751.502,349.814C752.873,352.435 756.11,356.556 758.691,361.056C768.12,356.938 782.894,362.154 797.058,375.22C813.613,390.733 818.306,409.765 808.66,420.324C797.84,429.058 786.238,428.928 775.288,420.585C774.506,425.539 771.899,440.269 754.822,447.569C738.267,450.567 717.8,439.878 717.018,409.635C716.355,384.112 727.176,373.022 737.292,368.966C737.645,363.745 738.873,356.959 739.69,347.391C717.557,339.874 612.254,322.197 567.634,326.774C572.627,331.35 580.115,343.415 585.316,353.816C586.761,356.705 588.122,360.413 589.47,364.504C604.653,368.887 634.98,378.502 646.183,414.146C659.525,456.593 644.803,494.783 644.958,502.647C645.199,514.863 649.551,526.227 649.551,526.227C649.551,526.227 639.24,512.077 629.075,503.954C615.709,493.275 596.267,487.642 581.568,450.894C569.881,421.677 576.197,384.33 576.66,365.632C569.294,352.981 559.941,339.604 547.248,327.24C497.25,328.429 404.288,345.466 347.863,391.399C356.384,395.298 369.157,402.142 384.644,420.772C409.697,425.029 455.993,444.042 472.917,467.252C497.149,500.485 497.201,541.172 508.855,564.48C517.212,581.195 524.734,590.11 524.734,590.11C524.734,590.11 507.938,571.507 476.817,562.529C455.909,556.498 408.841,549.436 382.653,516.005C352.104,477.006 361.723,442.247 356.337,417.164C349.608,413.516 342.011,410.137 333.363,407.127C273.105,472.533 269.23,590.869 301.809,673.867C375.387,674.164 468.659,674.507 558.467,674.808C563.162,659.664 605.617,591.787 611.382,585.221C616.213,579.13 619.195,579.276 624.801,578.766C663.169,577.429 738.63,577.793 767.279,578.672C773.284,579.115 778.014,583.194 779.543,587.271C787.629,602.949 811.75,649.253 820.281,675.551C844.431,675.593 861.759,675.603 869.783,675.571C874.613,654.491 893.501,638.747 916.037,638.747C942.226,638.747 963.488,660.009 963.488,686.198C963.488,712.387 942.226,733.649 916.037,733.649C893.81,733.649 875.132,718.334 869.989,697.69C837.337,697.839 785.983,697.9 725.304,697.889C712.265,721.39 682.402,770.2 672.195,785.474C670.343,788.246 667.147,789.96 663.386,790.206C654.395,790.793 637.657,791.786 618.204,792.799C612.907,806.219 585.414,869.018 577.76,873.267C568.111,878.623 416.318,881.905 402.263,882.208C401.45,882.226 395.765,882.349 393.001,878.004C372.519,845.811 296.257,719.256 283.386,696.919ZM582.21,674.887C664.861,675.159 742.759,675.389 797.364,675.506C784.12,651.515 769.412,620.418 761.368,601.539C758.31,602.049 642.466,602.728 628.198,601.369C618.954,616.887 594.788,656.31 582.21,674.887ZM700.39,697.881C576.865,697.823 422.342,697.497 307.459,697.023C336.008,744.454 371.767,804.526 403.537,861.521C452.435,858.739 545.641,855.042 569.285,855.969C574.252,841.009 592.156,807.38 598.868,793.764C565.299,795.367 528.821,796.698 510.989,796.113C507.723,807.886 496.921,816.539 484.113,816.539C468.722,816.539 456.227,804.043 456.227,788.652C456.227,773.261 468.722,760.765 484.113,760.765C495.248,760.765 504.867,767.305 509.336,776.75C531.734,773.921 618.117,769.127 656.005,769.615C667.731,751.075 687.969,716.424 700.39,697.881ZM745.101,367.072C746.964,366.905 748.649,366.961 750.043,367.171C749.046,364.71 747.689,360.994 745.453,359.282C745.094,361.828 745.288,364.726 745.101,367.072ZM751.658,367.519C751.67,367.522 751.682,367.526 751.693,367.529C751.703,367.511 751.714,367.493 751.724,367.475C751.702,367.49 751.68,367.504 751.658,367.519Z"
          style={{ fill: "white" }}
        />
        <path
          id="border"
          d="M483.833,216.304C485.339,214.27 486.995,212.193 488.815,210.075C489.416,209.377 490.074,208.729 490.782,208.14C507.79,193.986 522.477,191.379 533.513,192.504C546.543,193.833 555.662,200.708 560.293,205.962C563.342,209.241 569.463,217.61 569.854,230.563C569.921,232.811 569.824,235.255 569.468,237.878C569.932,237.063 570.413,236.249 570.912,235.436C586.975,209.256 621.929,183.249 671.96,181.022C735.115,178.211 803.96,231.458 803.96,231.458C810.701,236.753 812.289,246.316 807.621,253.505C802.953,260.695 793.571,263.135 785.991,259.131C785.991,259.131 773.417,253.373 754.292,259.217C738.892,263.922 718.599,271.621 701.758,280.053C742.629,292.021 791.189,309.492 840.083,333.17C841.193,332.984 842.36,332.808 843.574,332.644L844.415,330.64L847.659,326.036L851.484,322.366C859.949,315.562 876.21,311.415 895.26,314.534C909.549,316.874 920.209,324.391 929.081,332.222C931.713,334.544 934.156,336.857 936.524,338.885C937.93,340.088 938.966,341.482 940.378,341.821C947.328,343.489 953.743,342.681 953.743,342.681C960.923,341.714 967.899,345.526 970.963,352.092C974.027,358.657 972.468,366.452 967.115,371.335C967.115,371.335 954.945,382.488 936.324,387.992C937.012,388.54 937.582,389.03 938.02,389.457C938.589,390.011 939.117,390.606 939.601,391.235L942.7,397.473L943.403,401.697L943.186,406.58L940.945,414.148L935.965,421.63L931.364,425.486L925.201,428.343L918.026,429.341L910.937,428.244C909.409,427.789 907.955,427.116 906.619,426.246C894.989,418.668 861.951,404.382 827.187,391.355C832.34,406.818 829.776,421.769 820.889,431.497C820.325,432.114 819.715,432.688 819.064,433.213C807.919,442.21 796.26,445.426 784.689,443.069C780.31,450.299 773.158,457.745 761.333,462.8C760.19,463.288 758.996,463.647 757.774,463.868C742.432,466.647 724.911,461.825 713.092,447.425C706.078,438.881 700.89,426.694 700.46,410.064C699.747,382.634 709.568,367.593 720.602,359.435C692.869,353.144 638.251,344.477 598.277,342.818C598.919,344.025 599.539,345.224 600.131,346.408C600.843,347.833 601.546,349.418 602.239,351.132C621.605,357.693 650.258,371.869 661.985,409.179C672.376,442.239 667.718,472.973 663.896,491.442C662.879,496.359 661.734,501.932 661.534,502.905C661.84,511.995 665.02,520.302 665.02,520.302C667.991,528.059 664.758,536.816 657.46,540.781C650.162,544.747 641.056,542.695 636.164,535.982C636.164,535.982 627.42,523.834 618.735,516.895C603.789,504.953 582.626,498.14 566.188,457.046C554.506,427.84 558.83,391.138 559.915,369.896C554.671,361.336 548.383,352.509 540.533,344.065C497.6,346.213 428.452,359.081 377.751,390.482C382.626,394.437 387.894,399.381 393.488,405.659C422.488,412.268 468.562,433.165 486.3,457.493C499.727,475.906 506.645,496.302 511.63,515.405C515.799,531.379 518.271,546.274 523.67,557.072C530.942,571.615 537.394,579.428 537.394,579.428C543.224,586.337 542.437,596.644 535.627,602.589C528.817,608.533 518.498,607.92 512.44,601.21C512.44,601.21 498.237,585.948 472.226,578.445C449.306,571.833 398.321,562.867 369.614,526.219C348.688,499.506 344.118,474.591 342.604,452.703C341.993,443.857 342.039,435.622 341.28,428.14C340.314,427.694 339.331,427.253 338.329,426.819C291.345,486.412 288.323,584.133 313.387,657.35C382.057,657.624 466.015,657.932 547.867,658.208C560.884,632.696 592.268,582.575 598.53,574.777L598.404,574.928C607.465,563.503 612.787,563.226 623.301,562.27C623.608,562.242 623.916,562.223 624.224,562.212C662.884,560.865 738.92,561.23 767.788,562.116C768.024,562.123 768.26,562.136 768.496,562.153L777.499,564.184L784.994,568.332L790.878,574.071L795.052,581.455L794.264,579.678C801.497,593.701 821.143,631.597 831.895,659.006C842.401,659.02 851.22,659.027 858.072,659.026C868.301,637.266 890.42,622.183 916.037,622.183C951.368,622.183 980.052,650.868 980.052,686.198C980.052,721.529 951.368,750.213 916.037,750.213C890.786,750.213 868.933,735.559 858.517,714.3C827.847,714.408 784.837,714.457 734.962,714.454C720.277,740.017 695.195,780.869 685.967,794.678L681.617,799.687L676.341,803.381L670.528,805.71L664.466,806.734C657.085,807.217 644.505,807.971 629.487,808.786C622.009,826.244 607.866,857.52 598.628,873.031C593.669,881.357 588.529,886.234 585.8,887.749C583.227,889.177 573.243,891.537 558.493,892.734C513.963,896.349 413.936,898.524 402.621,898.769L394.263,897.792L388.151,895.382L383.357,892.005L379.026,886.896C360.288,857.445 295.032,749.298 273.863,713.439C233.101,713.246 199.228,713.033 176.233,712.806C165.584,733.389 144.095,747.472 119.341,747.472C84.01,747.472 55.326,718.788 55.326,683.457C55.326,648.126 84.01,619.442 119.341,619.442C145.136,619.442 167.384,634.736 177.517,656.739C180.23,656.755 183.26,656.772 186.591,656.79C136.079,441.51 265.879,326.216 342.285,291.323C344.13,280.479 347.525,270.293 351.842,260.902C344.638,253.291 339.055,243.988 337.425,231.975C335.353,216.705 339.832,195.481 361.209,165.74C390.112,125.529 444.002,122.27 467.304,121.973C486.174,121.733 498.965,124.596 511.785,127.421C522.321,129.742 532.882,132.038 548.521,131.445C555.08,131.197 561.167,134.845 564.041,140.746C566.914,146.647 566.032,153.689 561.791,158.699C558.254,162.878 552.548,166.645 544.91,169.922C534.868,174.231 519.752,178.301 506.296,189.536C497.449,196.924 490.395,205.798 483.833,216.304ZM283.386,696.919C296.257,719.256 372.519,845.811 393.001,878.004C395.765,882.349 401.45,882.226 402.263,882.208C416.318,881.905 568.111,878.623 577.76,873.267C585.414,869.018 612.907,806.219 618.204,792.799C637.657,791.786 654.395,790.793 663.386,790.206C667.147,789.96 670.343,788.246 672.195,785.474C682.402,770.2 712.265,721.39 725.304,697.889C785.983,697.9 837.337,697.839 869.989,697.69C875.132,718.334 893.81,733.649 916.037,733.649C942.226,733.649 963.488,712.387 963.488,686.198C963.488,660.009 942.226,638.747 916.037,638.747C893.501,638.747 874.613,654.491 869.783,675.571C861.759,675.603 844.431,675.593 820.281,675.551C811.75,649.253 787.629,602.949 779.543,587.271C778.014,583.194 773.284,579.115 767.279,578.672C738.63,577.793 663.169,577.429 624.801,578.766C619.195,579.276 616.213,579.13 611.382,585.221C605.617,591.787 563.162,659.664 558.467,674.808C468.659,674.507 375.387,674.164 301.809,673.867C269.23,590.869 273.105,472.533 333.363,407.127C342.011,410.137 349.608,413.516 356.337,417.164C361.723,442.247 352.104,477.006 382.653,516.005C408.841,549.436 455.909,556.498 476.817,562.529C507.938,571.507 524.734,590.11 524.734,590.11C524.734,590.11 517.212,581.195 508.855,564.48C497.201,541.172 497.149,500.485 472.917,467.252C455.993,444.042 409.697,425.029 384.644,420.772C369.157,402.142 356.384,395.298 347.863,391.399C404.288,345.466 497.25,328.429 547.248,327.24C559.941,339.604 569.294,352.981 576.66,365.632C576.197,384.33 569.881,421.677 581.568,450.894C596.267,487.642 615.709,493.275 629.075,503.954C639.24,512.077 649.551,526.227 649.551,526.227C649.551,526.227 645.199,514.863 644.958,502.647C644.803,494.783 659.525,456.593 646.183,414.146C634.98,378.502 604.653,368.887 589.47,364.504C588.122,360.413 586.761,356.705 585.316,353.816C580.115,343.415 572.627,331.35 567.634,326.774C612.254,322.197 717.557,339.874 739.69,347.391C738.873,356.959 737.645,363.745 737.292,368.966C727.176,373.022 716.355,384.112 717.018,409.635C717.8,439.878 738.267,450.567 754.822,447.569C771.899,440.269 774.506,425.539 775.288,420.585C786.238,428.928 797.84,429.058 808.66,420.324C818.306,409.765 813.613,390.733 797.058,375.22C782.894,362.154 768.12,356.938 758.691,361.056C756.11,356.556 752.873,352.435 751.502,349.814C796.894,359.986 893.569,397.973 915.662,412.368C924.793,415.086 928.149,403.52 926.461,401.321C918.49,393.556 864.503,363.927 847.856,355.211C851.76,354.258 855.711,353.559 859.593,353.075C864.497,361.372 877.389,359.833 885.413,364.185C890.599,366.996 897.205,375.456 918.717,374.361C940.429,373.256 955.952,359.097 955.952,359.097C955.952,359.097 946.62,360.353 936.513,357.927C924.318,355.001 914.304,334.438 892.583,330.881C873.591,327.771 858.22,332.827 857.66,342.907C857.555,344.803 857.628,346.48 857.856,347.967C849.792,348.385 842.441,349.281 837.904,350.54C761.723,312.981 685.743,290.821 638.869,281.346C653.376,280.716 670.683,278.555 682.106,271.849C701.352,260.55 729.342,249.52 749.452,243.376C776.173,235.211 793.729,244.485 793.729,244.485C793.729,244.485 730.712,194.988 672.697,197.57C610.889,200.321 575.113,243.964 576.633,272.057C559.512,270.578 543.031,269.895 527.255,269.899C530.952,267.744 534.92,264.901 539.151,261.21C561.884,236.426 551.179,220.298 548.039,217.112C542.598,210.761 525.819,200.532 501.377,220.872C476.19,250.175 489.848,267.744 493.485,270.985C448.5,273.917 410.561,282.523 381.519,293.673C382.788,283.436 384.756,274.28 387.19,266.098C408.683,273.733 440.523,263.449 452.772,238.873C466.209,211.914 477.81,191.744 495.679,176.822C517.023,158.999 541.77,156.715 549.148,147.998C514.309,149.318 502.06,138.096 467.515,138.536C447.23,138.794 399.82,140.403 374.659,175.408C339.307,224.592 355.227,243.892 372.448,257.119C364.819,270.289 358.806,285.712 357.554,302.813C284.724,331.582 144.527,447.882 207.998,673.462C187.343,673.363 172.608,673.282 165.684,673.224C160.999,651.947 142.017,636.006 119.341,636.006C93.152,636.006 71.89,657.268 71.89,683.457C71.89,709.646 93.152,730.908 119.341,730.908C141.145,730.908 159.534,716.169 165.081,696.12C188.858,696.41 230.929,696.68 283.386,696.919ZM745.101,367.072C745.288,364.726 745.094,361.828 745.453,359.282C747.689,360.994 749.046,364.71 750.043,367.171C748.649,366.961 746.964,366.905 745.101,367.072ZM751.658,367.519C751.68,367.504 751.702,367.49 751.724,367.475C751.714,367.493 751.703,367.511 751.693,367.529C751.682,367.526 751.67,367.522 751.658,367.519ZM582.21,674.887C594.788,656.31 618.954,616.887 628.198,601.369C642.466,602.728 758.31,602.049 761.368,601.539C769.412,620.418 784.12,651.515 797.364,675.506C742.759,675.389 664.861,675.159 582.21,674.887ZM612.579,658.422C670.967,658.609 725.715,658.77 769.928,658.879C762.772,644.66 755.923,630.152 750.579,618.205C723.518,618.58 663.237,618.875 637.346,618.3C630.743,629.208 621.38,644.451 612.579,658.422ZM700.39,697.881C687.969,716.424 667.731,751.075 656.005,769.615C618.117,769.127 531.734,773.921 509.336,776.75C504.867,767.305 495.248,760.765 484.113,760.765C468.722,760.765 456.227,773.261 456.227,788.652C456.227,804.043 468.722,816.539 484.113,816.539C496.921,816.539 507.723,807.886 510.989,796.113C528.821,796.698 565.299,795.367 598.868,793.764C592.156,807.38 574.252,841.009 569.285,855.969C545.641,855.042 452.435,858.739 403.537,861.521C371.767,804.526 336.008,744.454 307.459,697.023C422.342,697.497 576.865,697.823 700.39,697.881ZM670.33,714.426C563.118,714.342 438.11,714.078 336.789,713.702C360.715,753.693 387.862,799.738 412.948,844.416C457.355,842.064 526.161,839.37 558.126,839.272C561.784,830.929 566.663,820.925 571.353,811.549C552.545,812.288 534.671,812.801 521.418,812.812C513.492,825.02 499.74,833.103 484.113,833.103C459.58,833.103 439.663,813.185 439.663,788.652C439.663,764.119 459.58,744.201 484.113,744.201C497.384,744.201 509.306,750.028 517.452,759.262C546.747,756.637 610.176,753.244 646.825,753.028C653.712,741.855 662.246,727.611 670.33,714.426ZM460.325,257.593C463.529,257.171 466.775,256.778 470.064,256.414C469.638,250.342 470.32,242.947 473.615,234.417C471.641,238.201 469.647,242.148 467.597,246.261C465.561,250.346 463.11,254.127 460.325,257.593Z"
          style={{ fill: "white" }}
        />
      </g>

      {/* Curves Group - Main animated elements */}
      <g id="Curves">
        {/* Branch 3 */}
        <path
          ref={branch3Ref}
          id="branch3"
          d="M599.984,791.466C594.432,803.126 574.561,840.079 569.285,855.969C545.641,855.042 452.435,858.739 403.537,861.521C370.935,803.034 334.134,741.307 305.232,693.325C300.987,693.325 284.712,694.032 281.936,694.358C288.415,706.237 371.485,844.186 393.001,878.004C395.765,882.349 401.45,882.226 402.263,882.208C416.318,881.905 568.111,878.623 577.76,873.267C586.227,868.567 618.967,792.228 619.09,790.323C611.905,790.16 603.25,791.303 599.984,791.466Z"
          style={{ fill: "rgb(27,153,139)" }}
        />

        {/* Branch 2 */}
        <g id="branch2" ref={branch2Ref}>
          {/* Removed #full path - was always visible, interfering with animation */}
          <g
            ref={branch2CircleRef}
            id="_2"
            data-serif-id="2"
            transform="matrix(1.051639,0,0,1.051639,-23.970502,-40.051959)"
          >
            <circle
              cx="483.135"
              cy="788.012"
              r="26.517"
              style={{ fill: "rgb(46,41,78)" }}
            />
          </g>
          <path
            ref={branch2PathRef}
            id="_1"
            data-serif-id="1"
            d="M510.989,796.113C488.866,795.228 478.325,803.159 478.325,787.768C478.325,772.377 479.128,779.409 509.336,776.75C531.825,774.771 618.117,769.127 656.005,769.615C668.23,750.286 689.707,713.445 701.932,695.603C705.566,695.603 716.47,695.768 726.382,695.934C713.992,718.567 682.695,769.762 672.195,785.474C670.343,788.246 667.147,789.96 663.386,790.206C636.921,791.936 543.307,797.406 510.989,796.113Z"
            style={{ fill: "rgb(46,41,78)" }}
          />
        </g>

        {/* Branch 1 */}
        <path
          ref={branch1Ref}
          id="branch1"
          d="M558.046,676.957C566.03,676.957 578.939,676.447 581.147,676.447C593.377,658.612 618.686,617.336 628.198,601.369C642.466,602.728 758.31,602.049 761.368,601.539C769.691,621.073 785.148,653.686 798.737,677.976C803.153,678.316 818.61,677.976 820.988,677.806C813.175,651.987 787.866,603.408 779.543,587.271C778.014,583.194 773.284,579.115 767.279,578.672C738.63,577.793 663.169,577.429 624.801,578.766C619.195,579.276 616.213,579.13 611.382,585.221C605.267,592.185 557.876,668.124 558.046,676.957Z"
          style={{ fill: "rgb(46,41,78)" }}
        />

        {/* Leaf 5 */}
        <g
          ref={leaf5Ref}
          id="leaf5"
          transform="matrix(1,0,0,1,-2.15365,1.99982)"
        >
          <path
            d="M859.814,340.907C860.374,330.828 875.745,325.771 894.737,328.881C916.458,332.438 926.472,353.001 938.666,355.928C948.773,358.353 958.106,357.097 958.106,357.097C958.106,357.097 942.582,371.256 920.871,372.361C899.359,373.456 892.752,364.997 887.567,362.185C877.2,356.563 858.711,360.772 859.814,340.907Z"
            style={{ fill: "rgb(27,153,139)" }}
          />
        </g>

        {/* Leaf 4 */}
        <path
          ref={leaf4Ref}
          id="leaf4"
          d="M577.125,276.058C571.678,248.327 607.868,200.456 672.697,197.57C730.712,194.988 793.729,244.485 793.729,244.485C793.729,244.485 776.173,235.211 749.452,243.376C729.342,249.52 701.352,260.55 682.106,271.849C660.662,284.438 618.473,281.01 613.026,281.505C607.579,282.001 585.048,276.801 577.125,276.058Z"
          style={{ fill: "rgb(27,153,139)" }}
        />

        {/* Leaf 3 */}
        <path
          ref={leaf3Ref}
          id="leaf3"
          d="M575.443,355.349C580.649,364.536 566.868,414.146 581.568,450.894C596.267,487.642 615.709,493.275 629.075,503.954C639.24,512.077 649.551,526.227 649.551,526.227C649.551,526.227 645.199,514.863 644.958,502.647C644.803,494.783 659.525,456.593 646.183,414.146C634.045,375.528 599.458,367.463 586.005,363.505C579.575,357.38 585.105,367.421 575.443,355.349Z"
          style={{ fill: "rgb(27,153,139)" }}
        />

        {/* Leaf 2 */}
        <path
          ref={leaf2Ref}
          id="leaf2"
          d="M378.62,261.662C359.79,248.096 335.062,230.498 374.659,175.408C399.82,140.403 447.23,138.794 467.515,138.536C502.06,138.096 514.309,149.318 549.148,147.998C541.77,156.715 517.023,158.999 495.679,176.822C477.81,191.744 466.209,211.914 452.772,238.873C438.755,266.996 399.083,276.404 378.62,261.662Z"
          style={{ fill: "rgb(27,153,139)" }}
        />

        {/* Leaf 1 */}
        <path
          ref={leaf1Ref}
          id="leaf1"
          d="M355.073,412.371C363.152,437.721 350.107,474.457 382.653,516.005C408.841,549.436 455.909,556.498 476.817,562.529C507.938,571.507 524.734,590.11 524.734,590.11C524.734,590.11 517.212,581.195 508.855,564.48C497.201,541.172 497.149,500.485 472.917,467.252C453.415,440.507 394.911,419.334 374.853,419.891C364.824,415.991 367.331,414.044 355.073,412.371Z"
          style={{ fill: "rgb(27,153,139)" }}
        />

        {/* Olive 1 */}
        <path
          ref={olive1Ref}
          id="olive1"
          d="M493.856,271.295C499.497,275.739 515.051,282.234 539.151,261.21C561.884,236.426 551.179,220.298 548.039,217.112C542.598,210.761 525.819,200.532 501.377,220.872C475.226,251.297 490.951,269.073 493.856,271.295Z"
          style={{ fill: "rgb(197,216,109)" }}
        />

        {/* Tree */}
        <g id="tree" ref={treeRef}>
          <path
            ref={treeFullRef}
            id="full1"
            data-serif-id="full"
            d="M303.208,677.356C269.132,594.216 272.255,473.455 333.363,407.127C397.06,429.3 403.754,471.453 426.177,494.088C450.454,518.592 454.334,519.493 463.495,520.752C430.496,506.29 401.983,445.407 387.192,423.915C370.558,402.895 356.847,395.51 347.863,391.399C404.288,345.466 497.25,328.429 547.248,327.24C577.768,356.969 588.978,392.552 599.678,409.818C607.625,422.643 613.869,428.96 619.053,439.399C624.238,449.837 628.35,462.033 630.785,472.449C630.201,461.632 626.305,442.127 622.637,435.029C620.609,431.104 607.371,408.196 600.955,396.615C594.634,385.207 590.516,364.217 585.316,353.816C580.115,343.415 572.627,331.35 567.634,326.774C612.254,322.197 717.557,339.874 739.69,347.391C738.872,356.98 737.64,363.775 737.289,369.001C740.84,367.686 744.186,369.138 744.873,368.727C745.421,366.207 745.004,362.47 745.453,359.282C748.072,361.287 749.485,366.042 750.526,368.31C753.518,366.118 758.262,363.576 759.972,363.445C757.298,358.043 753.113,352.893 751.502,349.814C796.894,359.986 893.569,397.973 915.662,412.368C924.793,415.086 928.149,403.52 926.461,401.321C918.49,393.556 864.503,363.927 847.856,355.211C860.233,352.192 873.079,351.713 882.696,352.606C890.816,353.361 902.257,358.539 905.469,359.677C911.697,361.884 925.755,362.823 927.583,362.011C912.883,360.742 898.332,351.619 894.167,350.314C881.718,346.415 849.928,347.204 837.904,350.54C742.619,303.562 647.648,280.676 609.553,276.568C621.026,252.993 636.68,237.654 651.779,231.821C679.924,220.949 705.834,227.925 723.115,227.928C705.758,220.62 679.769,219.876 663.388,222.324C633.587,226.775 612.315,251.624 594.037,273.814C503.986,263.424 430.236,274.969 381.519,293.673C387.351,246.638 407.926,222.41 420.764,210.781C439.391,193.91 466.538,172.967 490.783,165.318C462.51,169.108 423.814,199.106 409.343,212.842C397.777,223.82 360.879,257.403 357.554,302.813C284.034,331.855 141.863,450.095 209.859,679.908C237.662,682.177 277.745,677.356 303.208,677.356Z"
            style={{
              fill: "rgb(46,41,78)",
              stroke: "rgb(46,41,78)",
              strokeWidth: 6,
            }}
          />
          <path
            ref={treeBaseRef}
            id="base"
            d="M303.208,677.356C269.132,594.216 272.255,473.455 333.363,407.127C336.745,403.456 340.759,397.182 347.863,391.399C404.288,345.466 497.25,328.429 547.248,327.24C553.023,327.103 565.084,327.036 567.634,326.774C612.254,322.197 717.557,339.874 739.69,347.391C743.358,348.637 748.502,349.142 751.502,349.814C796.894,359.986 893.569,397.973 915.662,412.368C924.793,415.086 928.149,403.52 926.461,401.321C918.49,393.556 864.503,363.927 847.856,355.211C844.964,353.697 842.804,352.956 837.904,350.54C742.619,303.562 647.648,280.676 609.553,276.568C605.397,276.12 599.6,274.456 594.037,273.814C503.986,263.424 430.236,274.969 381.519,293.673C372.691,297.062 363.323,300.534 357.554,302.813C284.034,331.855 141.863,450.095 209.859,679.908C237.662,682.177 277.745,677.356 303.208,677.356Z"
            style={{ fill: "rgb(46,41,78)" }}
          />
          <path 
            ref={treeGrow6Ref}
            id="grow6" 
            d="M 882.948673 396.07534 C 843.3206729999999 378.88833999999997, 784.553673 357.35334, 751.858673 350.02634 C 749.116673 349.41234, 744.398673 349.02333999999996, 741.045673 347.88434 C 718.384673 340.18834, 610.565673 322.11634, 564.880673 326.80233999999996 L 564.879673 326.80233999999996 C 562.424673 327.05534, 550.813673 327.08934, 545.254673 327.22033999999996 C 493.758673 328.44534, 398.092673 346.24534, 339.976673 393.55433999999997 C 332.413673 399.71134, 328.067673 406.32334, 324.466673 410.23233999999997 C 264.146673 475.70434, 257.623673 592.19334, 287.534673 677.69034 C 265.396673 678.66434, 237.589673 681.23934, 215.517673 680.32034 C 154.264673 462.18233999999995, 288.900673 349.33934, 359.353673 321.50934 C 365.101673 319.23834, 374.435673 315.78033999999997, 383.231673 312.40333999999996 C 430.893673 294.10434, 503.060673 282.95934, 591.161673 293.12433999999996 C 596.750673 293.76934, 602.574673 295.43634, 606.750673 295.88633999999996 C 644.308673 299.93734, 737.909673 322.59834, 831.851673 368.91533999999996 C 836.6476729999999 371.27934, 838.764673 371.99734, 841.594673 373.47934 C 849.668673 377.70734, 866.838673 386.95034, 882.948673 396.07534 Z" 
            style={{fill: "rgb(46,41,78)"}}
          />
          <path 
            ref={treeGrow5Ref}
            id="grow5" 
            d="M 790.394 360.184306 C 776.974 355.88030599999996, 764.691 352.364306, 754.779 350.14230599999996 C 752.177 349.559306, 747.692 349.23430599999995, 744.51 348.153306 C 721.561 340.35930599999995, 612.37 322.07230599999997, 566.105 326.81830599999995 L 566.102 326.81830599999995 C 563.699 327.06530599999996, 552.334 327.081306, 546.892 327.21030599999995 C 494.579 328.454306, 397.438 346.66930599999995, 338.401 394.72930599999995 C 330.587 401.090306, 326.06 407.888306, 322.34 411.925306 C 262.363 477.025306, 254.215 591.5333059999999, 282.068 678.043306 C 262.706 679.1003059999999, 240.242 680.8983059999999, 221.345 680.442306 C 163.784 468.730306, 294.295 358.87130599999995, 363.061 331.70730599999996 C 368.797 329.441306, 378.113 325.989306, 386.891 322.62030599999997 C 433.978 304.54130599999996, 505.281 293.615306, 592.319 303.65730599999995 C 597.921 304.304306, 603.761 305.973306, 607.947 306.424306 C 639.737 309.852306, 711.983 326.759306, 790.394 360.184306 Z" 
            style={{fill: "rgb(46,41,78)"}}
          />
          <path
            ref={treeGrow4Ref}
            id="grow4" 
            d="M 628.499226 329.47695999999996 C 606.006226 327.47996, 585.154226 326.72396, 570.485226 328.22796 L 570.481226 328.22896 C 568.173226 328.46596, 557.257226 328.44795999999997, 552.032226 328.57196 C 498.221226 329.85195999999996, 398.376226 348.82995999999997, 337.648226 398.26596 C 329.374226 405.00095999999996, 324.516226 412.13696, 320.577226 416.41195999999997 C 261.146226 480.91996, 250.321226 592.19196, 274.663226 680.17596 C 261.25622599999997 681.0009600000001, 247.132226 681.86496, 234.21822600000002 681.8959600000001 C 183.414226 482.04496, 306.343226 377.71896, 371.994226 351.78496 C 377.709226 349.52696, 386.991226 346.08896, 395.737226 342.73196 C 441.769226 325.05796, 511.48922600000003 314.53296, 596.577226 324.34996 C 602.205226 324.99896, 608.072226 326.67096, 612.277226 327.12396 C 616.865226 327.61896, 622.308226 328.39995999999996, 628.499226 329.47695999999996 Z"
            style={{fill: "rgb(46,41,78)"}}
          />
          <path
            ref={treeGrow3Ref}
            id="grow3" 
            d="M 425.371347 347.640211 C 388.494347 359.057211, 351.654347 375.749211, 323.185347 398.924211 C 314.49334699999997 406.00021100000004, 309.333347 413.443211, 305.196347 417.934211 C 246.20934699999998 481.960211, 233.220347 590.589211, 254.590347 679.555211 C 247.07834699999998 679.988211, 239.514347 680.358211, 232.224347 680.5152109999999 C 187.51234699999998 491.51921100000004, 303.541347 392.287211, 366.336347 367.48121100000003 C 372.032347 365.23121100000003, 381.283347 361.80521100000004, 390.000347 358.458211 C 400.553347 354.407211, 412.37834699999996 350.747211, 425.371347 347.640211 Z"
            style={{fill: "rgb(46,41,78)"}}
          />
          <path
            ref={treeGrow2Ref}
            id="grow2" 
            d="M 268.311 473.780758 C 239.784 535.0517580000001, 234.985 612.501758, 249.424 680.1777579999999 C 246.716 680.308758, 244.018 680.423758, 241.346 680.514758 C 221.605 591.318758, 238.686 522.969758, 268.311 473.780758 Z"
            style={{fill: "rgb(46,41,78)"}}
          />
          <path
            ref={treeGrow1Ref}
            id="grow1" 
            d="M 245.80206800000002 558.3715129999999 C 239.36106800000002 600.173513, 240.67606800000001 644.114513, 248.833068 684.787513 L 247.853068 684.827513 C 237.549068 636.5165129999999, 238.203068 594.456513, 245.80206800000002 558.371512999 Z"
            style={{fill: "rgb(46,41,78)"}}
          />
          <path
            ref={treeSeedRef}
            id="seed" 
            transform="matrix(1,0,0,1,1.308978,0)"
            d="M253.717,678.122 C261.955,678.122 268.639,679.839 268.639,681.958 C268.639,684.077 261.955,685.794 253.717,685.794 C245.479,685.794 238.795,684.077 238.795,681.958 C238.795,679.839 245.479,678.122 253.717,678.122 Z"
            style={{fill: "rgb(46,41,78)"}}
          />
        </g>

        {/* Olive 2 */}
        <path
          ref={olive2Ref}
          id="olive2"
          d="M751.693,367.529C743.35,365.053 715.975,369.485 717.018,409.635C717.8,439.878 738.267,450.567 754.822,447.569C771.899,440.269 774.506,425.539 775.288,420.585C786.238,428.928 797.84,429.058 808.66,420.324C818.306,409.765 813.613,390.733 797.058,375.22C778.547,358.144 758.993,354.475 751.693,367.529Z"
          style={{ fill: "rgb(197,216,109)" }}
        />

        {/* Main */}
        <g id="main">
          {/* Removed #full2 path - was always visible, interfering with animation */}
          <g
            ref={mainCircleRightRef}
            id="_3"
            data-serif-id="3"
            transform="matrix(1,0,0,1,-796.9814,-1.5132)"
          >
            <circle
              cx="916.18"
              cy="684.827"
              r="47.308"
              style={{ fill: "rgb(197,216,109)" }}
            />
          </g>
          <g
            ref={mainBarRef}
            id="_21"
            data-serif-id="2"
            transform="matrix(1.048852,0,0,1.379082,-2.176715,-261.617114)"
          >
            <path
              d="M879.011,686.987C879.011,691.881 873.788,695.853 867.354,695.853L122.794,695.853C116.36,695.853 111.136,691.881 111.136,686.987C111.136,682.094 116.36,678.121 122.794,678.121L867.354,678.121C873.788,678.121 879.011,682.094 879.011,686.987Z"
              style={{ fill: "rgb(197,216,109)" }}
            />
          </g>
          <g
            ref={mainCircleLeftRef}
            id="_11"
            data-serif-id="1"
            transform="matrix(1,0,0,1,0,1.5132)"
          >
            <circle
              cx="916.18"
              cy="684.827"
              r="47.308"
              style={{ fill: "rgb(197,216,109)" }}
            />
          </g>
        </g>
      </g>
    </svg>
  );
}
